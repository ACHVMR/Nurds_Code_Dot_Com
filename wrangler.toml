# ============================================
# Nurds Code - Cloudflare Workers Configuration (Dev-friendly)
# ============================================

name = "nurdscode-api"
main = "workers/api.js"
compatibility_date = "2024-10-30"
workers_dev = true

# Account configuration (optional for local dev)
# account_id can be set for deploy; omit/empty for local
# route only applies in production

# ============================================
# Development Configuration
# ============================================
[dev]
port = 8787
local_protocol = "http"

# ============================================
# Supabase Integration
# ============================================
[vars]
SUPABASE_URL = "https://qwwjmujbfnwbcyvfmfaj.supabase.co"
SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF3d2ptdWpiZm53YmN5dmZtZmFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NzAwNzQsImV4cCI6MjA3NzQ0NjA3NH0.iXUI0CHL4WwVTpstR4rXU0ENA_SsSDaWfpohYjW_v48"

# Voice AI Configuration
VOICE_ENABLED = "true"
VOICE_DEFAULT_PROVIDER = "openai"
OPENAI_VOICE_MODEL = "whisper-1"
OPENAI_TTS_MODEL = "tts-1"
OPENAI_TTS_VOICE = "alloy"
ENABLE_GPT5 = "false"

# ACHEEVY Orchestrator (optional bridge)
AGENT_CORE_URL = ""

# Authentication (Clerk)
CLERK_FRONTEND_API_URL = "https://precise-lamprey-55.clerk.accounts.dev"
CLERK_BACKEND_API_URL = "https://api.clerk.com"
CLERK_JWKS_URL = "https://precise-lamprey-55.clerk.accounts.dev/.well-known/jwks.json"

# RBAC
ADMIN_ALLOWLIST = ""
CLERK_ORG_ID_SUPERADMINS = ""
CLERK_SUPERADMIN_ROLE = "owner"

# Stripe (publishable only here; secrets set via wrangler secret)
STRIPE_PUBLISHABLE_KEY = "pk_live_51LPsOjHW9f80DXRWn1sPqOxChAwxi2e2VkxNBS3KH5e5nAHGyIn4hFOtEeXieH3h9ZH6Etzdwh6SKlZ3iPvx41Ow00Y2WF0Icg"

# AI Gateway (optional)
AI_GATEWAY_ACCOUNT_ID = ""
AI_GATEWAY_GATEWAY_NAME = "nurdscode-gateway"

MAX_REQUESTS_PER_MINUTE = "60"
RESPONSE_TIMEOUT_MS = "30000"

# ============================================
# AI Bindings (Cloudflare Workers AI)
# ============================================
[ai]
binding = "AI"

# ============================================
# Compatibility Flags
# ============================================
compatibility_flags = [
  "nodejs_compat",
  "transformstream_enable_standard_constructor",
  "streams_enable_constructors"
]

# ============================================
# Observability
# ============================================
[observability]
enabled = true

# ============================================
# Environment: Production (bindings only for deploy)
# ============================================
[env.production]
name = "nurdscode-api-prod"
route = "api.nurdscode.com/*"

# KV / R2 / Durable Objects / Analytics can be set here for prod only
# [[env.production.kv_namespaces]]
# binding = "CACHE"
# id = "<kv-id>"

# [[env.production.r2_buckets]]
# binding = "ASSETS"
# bucket_name = "nurdscode-assets-prod"

# [[env.production.durable_objects.bindings]]
# name = "CHAT_ROOMS"
# class_name = "ChatRoom"
# script_name = "nurdscode-api-prod"
